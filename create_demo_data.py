import pandas as pd
import numpy as np

# ----------------------------------------------------------------
# Все регионы РФ по федеральным округам
# ----------------------------------------------------------------
federal_districts = {
    "Центральный ФО": [
        "Белгородская область","Брянская область","Владимирская область","Воронежская область",
        "Ивановская область","Калужская область","Костромская область","Курская область",
        "Липецкая область","Московская область","Орловская область","Рязанская область",
        "Смоленская область","Тамбовская область","Тверская область","Тульская область",
        "Ярославская область","Москва"
    ],
    "Северо-Западный ФО": [
        "Республика Карелия","Республика Коми","Архангельская область","Вологодская область",
        "Калининградская область","Ленинградская область","Мурманская область",
        "Новгородская область","Псковская область","Санкт-Петербург","Ненецкий АО"
    ],
    "Южный ФО": [
        "Республика Адыгея","Республика Калмыкия","Республика Крым","Краснодарский край",
        "Астраханская область","Волгоградская область","Ростовская область","Севастополь"
    ],
    "Северо-Кавказский ФО": [
        "Республика Дагестан","Ингушетия","Кабардино-Балкарская Республика","Карачаево-Черкесская Республика",
        "Республика Северная Осетия — Алания","Чеченская Республика","Ставропольский край"
    ],
    "Приволжский ФО": [
        "Республика Башкортостан","Республика Марий Эл","Республика Мордовия","Республика Татарстан",
        "Удмуртская Республика","Чувашская Республика","Кировская область","Нижегородская область",
        "Оренбургская область","Пензенская область","Пермский край","Самарская область",
        "Саратовская область","Ульяновская область"
    ],
    "Уральский ФО": [
        "Курганская область","Свердловская область","Тюменская область","Челябинская область",
        "Ханты-Мансийский автономный округ","Ямало-Ненецкий автономный округ"
    ],
    "Сибирский ФО": [
        "Республика Алтай","Республика Бурятия","Республика Тыва","Республика Хакасия",
        "Алтайский край","Забайкальский край","Красноярский край","Иркутская область",
        "Кемеровская область","Новосибирская область","Омская область","Томская область"
    ],
    "Дальневосточный ФО": [
        "Республика Саха (Якутия)","Камчатский край","Приморский край","Хабаровский край",
        "Амурская область","Магаданская область","Сахалинская область","Еврейская автономная область",
        "Чукотский автономный округ"
    ]
}

# ----------------------------------------------------------------
# Генерация реалистичных данных
# ----------------------------------------------------------------
np.random.seed(42)

all_regions = [r for regions in federal_districts.values() for r in regions]

data = {
    "Регион": all_regions,
    "Рост вкладов (%)": np.random.uniform(2.0, 18.0, size=len(all_regions)).round(2),
    "Качество кредитного портфеля (NPL, %)": np.random.uniform(0.8, 7.5, size=len(all_regions)).round(2),
    "Проникновение цифровых услуг (%)": np.random.uniform(40, 98, size=len(all_regions)).round(1),
    "Удовлетворенность клиентов (1-5)": np.random.uniform(3.2, 5.0, size=len(all_regions)).round(1),
}

df = pd.DataFrame(data)

# ----------------------------------------------------------------
# Коррекция NPL для крупных финансовых центров
# ----------------------------------------------------------------
better_npl = ["Москва", "Санкт-Петербург", "Республика Татарстан"]
df.loc[df["Регион"].isin(better_npl), "Качество кредитного портфеля (NPL, %)"] /= 2

# ----------------------------------------------------------------
# Сохранение файла
# ----------------------------------------------------------------
file_path = "demo_data_full.xlsx"
df.to_excel(file_path, index=False)

print(f"Demo file created → {file_path}")
